package ubu.itig;

import com.jcraft.jsch.JSch;
import com.jcraft.jsch.Session;
import com.jcraft.jsch.UserInfo;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.ProgressBar;
import android.widget.TextView;

public class PestanaMainManual extends Activity {
	private Button conectar;

	private TextView ip;
	private TextView usuario;
	private TextView contrasena;
	private TextView puerto;
	private ProgressBar barra;
	private JSch jsch;
	private Session session;

	/** Called when the activity is first created. */
	@Override
	public void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.pestanamainmanual);
		inicializa();
	}

	private void inicializa() {
		conectar = (Button) findViewById(R.id.btConnect);

		ip = (TextView) findViewById(R.id.tvHost);
		usuario = (TextView) findViewById(R.id.tvUser);
		contrasena = (TextView) findViewById(R.id.tvPass);
		puerto = (TextView) findViewById(R.id.tvPort);
		barra = (ProgressBar) findViewById(R.id.progressBar1);
		conectar.setOnClickListener(new listenerConectar());

	}

	private class listenerConectar implements View.OnClickListener {

		public void onClick(View arg0) {
			// TODO Auto-generated method stub
			if (jsch == null && session == null) {
				try {
					int p = Integer.parseInt(puerto.getText().toString());
					System.out.println(puerto.getText());
					jsch = new JSch();
					session = jsch.getSession(usuario.getText().toString(), ip
							.getText().toString(), p);
					System.out.println(usuario.getText().toString()+ip
							.getText().toString());
					UserInfo ui = new SUserInfo(contrasena.getText().toString(), null);
					session.setUserInfo(ui);
					session.setPassword(contrasena.getText().toString());
					session.connect();
					

					Log.i("conectado", null);
					// System.out.println("------ FIN");
				} catch (Exception e) {
					// TODO: handle exception

				}
			}
		}

	}
}